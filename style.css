:root{
  --bg:#04040c; --s1:#0b0b16; --s2:#11111e; --s3:#191928;
  --border:#22223a; --border2:#2e2e48;
  --gold:#d4a853; --gold2:#f5d07a; --gold3:#ffe9a0;
  --cream:#f2ead8; --rose:#e06b6b; --sage:#72c9a0; --lav:#a48de0;
  --text:#ece8f5; --muted:#4e4e72; --muted2:#7070a0;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{
  font-family:'Outfit',sans-serif;
  background: radial-gradient(circle at 50% 0%, #1c1c2e 0%, #04040c 80%);
  color:var(--text); min-height:100vh; overflow-x:hidden;
}

/* TOP NAVIGATION & LOGO (Fix 5) */
.top-nav {
  position: absolute;
  top: 25px;
  left: 30px;
  right: 30px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  z-index: 100;
}
.header { text-align: left; padding: 0; animation: none; }
.logo-AS { font-family:'Playfair Display',serif; font-size: 42px; font-weight:900; line-height:1; background:linear-gradient(135deg,#b07828 0%,var(--gold) 25%,var(--gold3) 50%,var(--gold) 75%,#b07828 100%); background-size:300%; -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:goldShimmer 4s linear infinite; filter:drop-shadow(0 0 15px rgba(212,168,83,0.4)); }
.logo-dash { font-family:'Playfair Display',serif; font-size: 32px; color:rgba(212,168,83,0.3); margin:0 4px; line-height:1; }
.logo-pire { font-family:'Playfair Display',serif; font-size: 42px; font-weight:700; font-style:italic; color:var(--cream); opacity:0.88; letter-spacing:-1px; line-height:1; }
.streak-badge { font-family:'JetBrains Mono',monospace; font-size:11px; color:var(--rose); background:rgba(224,107,107,0.1); padding:4px 10px; border-radius:20px; border:1px solid rgba(224,107,107,0.2); display:inline-flex; align-items:center; gap:6px; margin-top:8px; }

.nav-actions { display: flex; gap: 12px; }
.icon-btn { background: var(--s1); border: 1px solid var(--border2); color: var(--gold); padding: 8px 16px; border-radius: 8px; font-family: 'Outfit', sans-serif; cursor: pointer; transition: all 0.3s; font-size: 13px; font-weight: 500;}
.icon-btn:hover { border-color: var(--gold); box-shadow: 0 0 15px rgba(212,168,83,0.2); transform: translateY(-2px); }

/* ANIMATIONS */
@keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
.shake-screen { animation: shake 0.5s; }
@keyframes meshDrift{0%{filter:hue-rotate(0deg);}100%{filter:hue-rotate(20deg) brightness(1.08);}}
@keyframes sparkFade{0%{opacity:0.9;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-50%) scale(0);}}
@keyframes goldShimmer{0%{background-position:0%;}100%{background-position:300%;}}

#starCanvas{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:0.55;}
.mesh{position:fixed;inset:0;z-index:0;pointer-events:none; background:radial-gradient(ellipse 700px 500px at 5% 10%,rgba(212,168,83,0.07) 0%,transparent 60%), radial-gradient(ellipse 600px 600px at 90% 80%,rgba(164,141,224,0.07) 0%,transparent 60%), radial-gradient(ellipse 400px 400px at 50% 50%,rgba(114,201,160,0.04) 0%,transparent 60%); animation:meshDrift 12s ease-in-out infinite alternate;}
body::after{content:'';position:fixed;inset:0;z-index:9999;pointer-events:none; background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='1'/%3E%3C/svg%3E"); opacity:0.025;}

.cursor-spark{position:fixed;pointer-events:none;z-index:9997;border-radius:50%;background:var(--gold);animation:sparkFade 0.6s ease forwards;transform:translate(-50%,-50%);}
.wrap{position:relative;z-index:1;max-width:860px;margin:0 auto;padding:100px 22px 100px;} /* Increased top padding */

/* STICKY */
.sticky-stage{display:flex;justify-content:center;margin-bottom:-6px;}
.sticky{background:linear-gradient(160deg,#fefce8 78%,#fef3c7);width:316px;padding:18px 20px 14px; border-radius:2px 2px 6px 2px; box-shadow:0 2px 2px rgba(0,0,0,0.2),0 10px 40px rgba(0,0,0,0.55),0 0 0 1px rgba(212,168,83,0.2); transform:rotate(-2.2deg);transition:transform 0.5s cubic-bezier(0.34,1.56,0.64,1),box-shadow 0.4s; position:relative;}
.sticky::before{content:'';position:absolute;top:-12px;left:50%;transform:translateX(-50%); width:28px;height:22px;background:linear-gradient(135deg,rgba(212,168,83,0.6),rgba(160,120,20,0.4)); border-radius:2px;box-shadow:0 2px 5px rgba(0,0,0,0.4);}
.sticky:hover{transform:rotate(0deg) scale(1.06);box-shadow:0 4px 4px rgba(0,0,0,0.25),0 20px 60px rgba(0,0,0,0.65),0 0 0 1px rgba(212,168,83,0.35);}
.s-hdr{font-family:'JetBrains Mono',monospace;font-size:9px;text-transform:uppercase;letter-spacing:3px;color:#9a7015;margin-bottom:8px;}
.s-body{font-family:'Outfit',sans-serif;font-size:14px;font-style:italic;color:#221800;line-height:1.6; background:transparent;border:none;outline:none;width:100%;resize:none;min-height:44px; position:relative;z-index:2;font-weight:400;cursor:text;}
.s-saved{font-family:'JetBrains Mono',monospace;font-size:9px;color:#9a7015;margin-top:4px; opacity:0;transition:opacity 0.3s;text-align:right;}
.s-saved.show{opacity:1;}

.demo-banner{background:linear-gradient(135deg,rgba(212,168,83,0.07),rgba(164,141,224,0.05)); border:1px solid rgba(212,168,83,0.18);border-radius:12px;padding:11px 18px;margin-bottom:22px; font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--gold); display:flex;align-items:center;gap:8px;}
.profile-bar{display:flex;align-items:center;justify-content:center;gap:14px;margin-bottom:26px;}
.profile-lbl{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;}
.p-btn{position:relative;display:flex;align-items:center;gap:10px;padding:11px 28px;border-radius:50px; border:1.5px solid var(--border2);background:var(--s1);color:var(--muted2); font-size:14px;font-family:'Outfit',sans-serif;font-weight:500;cursor:pointer;overflow:hidden; transition:color 0.3s,border-color 0.35s,transform 0.3s cubic-bezier(0.34,1.56,0.64,1),box-shadow 0.35s;}
.p-btn:hover{transform:translateY(-4px) scale(1.03);border-color:rgba(212,168,83,0.45);color:var(--gold2);box-shadow:0 8px 30px rgba(0,0,0,0.35);}
.p-btn.active{border-color:var(--gold);color:var(--gold);background:rgba(212,168,83,0.07); box-shadow:0 0 35px rgba(212,168,83,0.2),0 4px 20px rgba(0,0,0,0.3);}
.p-avatar{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center; font-size:11px;font-weight:700;flex-shrink:0;}
.av-you{background:linear-gradient(135deg,#d4a853,#f5d07a);color:#1a0f00;}
.av-friend{background:linear-gradient(135deg,#9b8ec4,#c4b5f4);color:#1a0f2e;}
.nudge-btn{ width:40px; height:40px; border-radius:50%; border:1px solid var(--border2); background:var(--s1); color:var(--gold); display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:16px; transition:all 0.3s; }
.nudge-btn:hover{ transform:scale(1.1) rotate(10deg); border-color:var(--gold); box-shadow:0 0 15px rgba(212,168,83,0.3); }

.friend-notice{display:flex;align-items:center;gap:10px;background:rgba(164,141,224,0.08); border:1px solid rgba(164,141,224,0.2);border-radius:10px;padding:10px 16px;margin-bottom:18px; font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--lav);}
.tab-wrap{position:relative;display:flex;background:var(--s1);border:1px solid var(--border); border-radius:16px;padding:5px;margin-bottom:22px;}
.tab-pill{position:absolute;top:5px;height:calc(100% - 10px);width:calc(50% - 5px); background:linear-gradient(135deg,rgba(212,168,83,0.18),rgba(164,141,224,0.14)); border:1px solid rgba(212,168,83,0.28);border-radius:12px; transition:transform 0.48s cubic-bezier(0.34,1.4,0.64,1);pointer-events:none;}
.tab-pill.right{transform:translateX(calc(100% + 10px));}
.tab-btn{flex:1;padding:14px;border:none;background:transparent;color:var(--muted); font-size:13px;font-family:'JetBrains Mono',monospace;letter-spacing:1px;cursor:pointer; border-radius:12px;position:relative;z-index:1; transition:color 0.3s,transform 0.25s cubic-bezier(0.34,1.4,0.64,1); display:flex;align-items:center;justify-content:center;gap:9px;}
.tab-btn.active{color:var(--gold);font-weight:700;}

.cdown{display:flex;align-items:center;justify-content:space-between;background:var(--s1); border:1px solid var(--border);border-radius:12px;padding:12px 18px;margin-bottom:20px;}
.cd-lbl{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;}
.cd-val{font-family:'JetBrains Mono',monospace;font-size:15px;color:var(--sage);font-weight:700;display:flex;align-items:center;gap:8px;}
.live-dot{width:8px;height:8px;border-radius:50%;background:var(--sage);box-shadow:0 0 8px var(--sage);animation:livePulse 1.4s ease-in-out infinite;}
@keyframes livePulse{0%,100%{transform:scale(1);opacity:1;}50%{transform:scale(0.4);opacity:0.3;}}

.prog-wrap{margin-bottom:24px;}
.prog-row{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:12px;}
.prog-lbl{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;}
.prog-pct{font-family:'Playfair Display',serif;font-size:24px;color:var(--gold);line-height:1;transition:all 0.5s;}
.prog-track{height:6px;background:var(--s3);border-radius:3px;overflow:hidden;}
.prog-fill{height:100%;background:linear-gradient(90deg,var(--sage),var(--lav),var(--gold2)); background-size:200%;animation:progShimmer 3s linear infinite; border-radius:3px;transition:width 0.75s cubic-bezier(0.34,1.56,0.64,1);}

.add-row{display:flex;gap:10px;margin-bottom:22px;}
.t-input{flex:1;background:var(--s1);border:1.5px solid var(--border);border-radius:14px; padding:14px 18px;color:var(--text);font-size:14px;font-family:'Outfit',sans-serif; outline:none;transition:border-color 0.3s,box-shadow 0.3s,background 0.3s;}
.t-input:focus{border-color:rgba(212,168,83,0.5);box-shadow:0 0 0 4px rgba(212,168,83,0.07);background:var(--s2);}
.add-btn{width:52px;height:52px;flex-shrink:0;border-radius:14px; border:1.5px solid rgba(212,168,83,0.4);background:var(--s1);color:var(--gold);font-size:28px; cursor:pointer;display:flex;align-items:center;justify-content:center; transition:all 0.3s;}
.add-btn:hover{transform:scale(1.15) rotate(90deg);box-shadow:0 0 35px rgba(212,168,83,0.4);border-color:var(--gold);}

/* FIX 1: Blinking Tasks resolved by specific .task-new class */
.tasks{display:flex;flex-direction:column;gap:10px;}
.task{background:var(--s1);border:1px solid var(--border);border-radius:14px; padding:15px 16px;display:flex;align-items:center;gap:14px; transition:background 0.25s,border-color 0.25s,transform 0.3s cubic-bezier(0.34,1.3,0.64,1),box-shadow 0.3s; position:relative;overflow:hidden;}
.task.task-new { animation:taskIn 0.5s cubic-bezier(0.34,1.4,0.64,1) both; }
@keyframes taskIn{from{opacity:0;transform:translateX(-22px) scale(0.95);}to{opacity:1;transform:translateX(0) scale(1);}}

.task::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px; background:linear-gradient(180deg,var(--gold),var(--lav)); transform:scaleY(0);transform-origin:bottom; transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1);border-radius:0 3px 3px 0;}
.task.done::before{transform:scaleY(1);}
.task:hover{border-color:rgba(212,168,83,0.22);background:var(--s2);transform:translateX(6px);box-shadow:0 4px 24px rgba(0,0,0,0.3);}
.task.done{background:rgba(114,201,160,0.04);border-color:rgba(114,201,160,0.15);}

.chk{width:27px;height:27px;border-radius:50%;border:2px solid var(--border2);cursor:pointer; display:flex;align-items:center;justify-content:center;flex-shrink:0; transition:all 0.35s;position:relative;}
.chk::before{content:'';position:absolute;inset:0;border-radius:50%; background:radial-gradient(circle,var(--sage),#059669); transform:scale(0);transition:transform 0.35s;}
.chk.on{border-color:var(--sage);box-shadow:0 0 20px rgba(114,201,160,0.55);}
.chk.on::before{transform:scale(1);}
.chk-mark{color:white;font-size:12px;position:relative;z-index:1;font-weight:700; opacity:0;transform:scale(0) rotate(-40deg);transition:all 0.3s;}
.chk.on .chk-mark{opacity:1;transform:scale(1) rotate(0);}

.task-txt{flex:1;font-size:15px;font-weight:400;line-height:1.4;transition:color 0.3s;}
.task.done .task-txt{color:var(--muted);text-decoration:line-through;text-decoration-color:var(--muted);}
.task-by{font-size:10px;font-family:'JetBrains Mono',monospace;color:var(--muted); background:var(--s3);padding:3px 10px;border-radius:50px; border:1px solid var(--border);}
.del-btn{background:none;border:none;width:30px;height:30px;border-radius:8px; display:flex;align-items:center;justify-content:center;color:var(--muted);cursor:pointer; font-size:18px;opacity:0; transition:opacity 0.2s,color 0.2s,transform 0.3s;}
.task:hover .del-btn{opacity:1;}
.del-btn:hover{color:var(--rose);background:rgba(224,107,107,0.12);transform:scale(1.25) rotate(15deg);}

.empty{text-align:center;padding:50px 20px;}
.empty-icon{font-size:48px;margin-bottom:14px;opacity:0.35;}
.empty-txt{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--muted);letter-spacing:1px;}

.all-done{background:linear-gradient(135deg,rgba(114,201,160,0.1),rgba(212,168,83,0.1)); border:1px solid rgba(114,201,160,0.25);border-radius:14px;padding:22px;text-align:center; margin-top:20px;display:none;}
.all-done.show{display:block;}
.all-done-title{font-family:'Playfair Display',serif;font-size:22px;font-style:italic;color:var(--gold);margin-bottom:5px;}
.all-done-sub{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--sage);letter-spacing:1px;}

/* MODALS */
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);backdrop-filter:blur(8px);z-index:200;align-items:center;justify-content:center;}
.overlay.show{display:flex;}
.modal{background:var(--s1);border:1px solid var(--border2);border-radius:22px;padding:34px; width:90%;max-width:380px;box-shadow:0 40px 100px rgba(0,0,0,0.7);}
.modal-title{font-family:'Playfair Display',serif;font-size:32px;font-weight:700;font-style:italic;color:var(--gold);margin-bottom:10px;}
.m-field{margin-bottom:14px;}
.m-field label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:7px;display:block;}
.m-input{width:100%;background:var(--s2);border:1px solid var(--border2);border-radius:10px; padding:12px 16px;color:var(--text);font-size:14px;font-family:'Outfit',sans-serif;outline:none;}
.m-btns{display:flex;gap:10px;margin-top:24px;}
.m-btn{flex:1;padding:13px;border-radius:12px;border:none;font-size:14px;font-family:'Outfit',sans-serif; font-weight:600;cursor:pointer;transition:transform 0.3s;}
.m-btn.primary{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#1a0f00;}
.m-btn.secondary{background:var(--s3);color:var(--muted2);}

.sync-pill{position:fixed;bottom:22px;right:22px;display:flex;align-items:center;gap:7px; background:var(--s2);border:1px solid var(--border);border-radius:50px;padding:7px 14px; font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);z-index:50;}
.sync-dot{width:7px;height:7px;border-radius:50%;}
.sync-dot.live{background:var(--sage);box-shadow:0 0 8px var(--sage);animation:livePulse 1.4s infinite;}
.sync-dot.local{background:var(--gold);box-shadow:0 0 6px var(--gold);}

/* Effects from original */
.cf{position:fixed;pointer-events:none;z-index:9998;animation:cfFall linear forwards;}
@keyframes cfFall{0%{transform:translateY(-5vh) rotate(0deg);opacity:1;}80%{opacity:1;}100%{transform:translateY(110vh) rotate(1200deg);opacity:0;}}
.float-emoji{position:fixed;font-size:32px;pointer-events:none;z-index:9999;animation:floatUp 2s ease-in forwards;}
@keyframes floatUp{0%{transform:translateY(0) scale(0.5);opacity:0;} 10%{opacity:1;transform:translateY(-20px) scale(1.2);} 100%{transform:translateY(-200px) scale(1);opacity:0;}}
